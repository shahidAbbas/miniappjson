<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Status Bar Color Demo</title>

    <!-- Android/modern browsers -->
    <meta name="theme-color" content="#111111" id="themeColorMeta" />

    <!-- iOS PWA hints (installed web app) -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <style>
      :root {
        --status-color: #111111; /* initial color */
      }
      html, body {
        height: 100%;
        margin: 0;
        background: #fff; /* white background as requested */
        color: #0f172a; /* slate-900 */
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      }
      .page {
        min-height: 100dvh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: calc(env(safe-area-inset-top, 0px) + 16px) 16px 24px;
        gap: 20px;
      }
      .pointer {
        display: block;
        width: 28px;
        height: 160px; /* tall enough to clearly point at status bar */
        color: #111; /* arrow color */
      }
      .caption {
        text-align: center;
        font-size: 16px;
        line-height: 1.35;
      }
      .caption strong { color: var(--status-color); }

      .panel {
        width: 100%;
        max-width: 520px;
        border: 1px solid #e5e7eb; /* gray-200 */
        border-radius: 16px;
        padding: 14px;
        box-shadow: 0 1px 2px rgba(0,0,0,0.06);
      }
      .row { display: flex; align-items: center; gap: 10px; }
      label { font-size: 14px; color: #334155; min-width: 78px; }
      input[type="text"] {
        flex: 1;
        font-size: 16px;
        padding: 10px 12px;
        border-radius: 12px;
        border: 1px solid #cbd5e1; /* gray-300 */
        outline: none;
      }
      input[type="text"]:focus { border-color: #64748b; /* slate-500 */ }
      button {
        appearance: none;
        border: none;
        border-radius: 12px;
        padding: 10px 14px;
        font-size: 15px;
        background: #111;
        color: #fff;
        cursor: pointer;
      }
      .swatch {
        width: 24px; height: 24px; border-radius: 6px; border: 1px solid #e5e7eb; background: var(--status-color);
      }
      .hint { font-size: 12px; color: #64748b; margin-top: 8px; }
      .error { color: #b91c1c; font-size: 13px; display: none; margin-top: 8px; }
    </style>
  </head>
  <body>
    <main class="page">
      <!-- Arrow pointing toward the status bar (top of the screen) -->
      <svg class="pointer" viewBox="0 0 24 160" aria-hidden="true">
        <defs>
          <marker id="arrowhead" markerWidth="6" markerHeight="6" refX="3" refY="3" orient="auto">
            <polygon points="0 0, 6 3, 0 6"></polygon>
          </marker>
        </defs>
        <line x1="12" y1="150" x2="12" y2="8" stroke="currentColor" stroke-width="3" marker-end="url(#arrowhead)"></line>
      </svg>

      <p class="caption">Status bar color should be <strong id="colorText">#111111</strong>.</p>

      <section class="panel" role="region" aria-labelledby="controlTitle">
        <div class="row">
          <label id="controlTitle" for="colorInput">colorSet</label>
          <input id="colorInput" type="text" placeholder="#111111 | rgb(17,17,17) | tomato" autocomplete="off" />
          <span class="swatch" title="Preview"></span>
          <button id="applyBtn" type="button">Apply</button>
        </div>
        <div id="error" class="error">That doesnâ€™t look like a valid CSS color. Try a hex value like <code>#ff6600</code> or a named color like <code>tomato</code>.</div>
        <p class="hint">Tip: This updates <code>&lt;meta name="theme-color"&gt;</code> so supported browsers tint the status bar. On iOS, the effect is most visible when the page is added to Home Screen or in newer Safari versions.</p>
      </section>
    </main>

    <script>
      const meta = document.querySelector('#themeColorMeta');
      const input = document.querySelector('#colorInput');
      const btn = document.querySelector('#applyBtn');
      const text = document.querySelector('#colorText');
      const swatch = document.querySelector('.swatch');
      const errorEl = document.querySelector('#error');

      function isValidCssColor(value) {
        const s = new Option().style; // creates a CSSStyleDeclaration
        s.color = '';
        s.color = value.trim();
        return s.color !== '';
      }

      function setThemeColor(color) {
        document.documentElement.style.setProperty('--status-color', color);
        meta.setAttribute('content', color);
        text.textContent = color;
        swatch.style.background = color;
        try { localStorage.setItem('statusbarColor', color); } catch (_) {}
      }

      function apply() {
        const val = input.value.trim();
        if (!val) return;
        if (!isValidCssColor(val)) {
          errorEl.style.display = 'block';
          return;
        }
        errorEl.style.display = 'none';
        setThemeColor(val);
      }

      btn.addEventListener('click', apply);
      input.addEventListener('keydown', (e) => { if (e.key === 'Enter') apply(); });

      // Restore previous color or default
      (function init() {
        let saved = null;
        try { saved = localStorage.getItem('statusbarColor'); } catch (_) {}
        const initial = saved || getComputedStyle(document.documentElement).getPropertyValue('--status-color').trim() || '#111111';
        setThemeColor(initial);
        input.value = initial;
      })();
    </script>
  </body>
</html>
